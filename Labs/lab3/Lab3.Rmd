---
title: "Lab_3"
author: "Nikitin Dmitry RI-450004"
date: '4 октября 2018 г '
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
### Задание 1
1. Используйте команду ``readLines`` для загрузки файла в текстовый вектор _html_.
```{r}
html<-readLines("/home/dmitry/Документы/Учеба/MD-DA-2018-Results/Labs/lab3/forbes.htm" )
```
   1. Сколько строк в файле?
```{r}
length(html)
```
   2. Сколько символов в файле?
```{r}
sum(nchar(html))
```
2. Откройте файл в текстовом редакторе. Найдите строки, содержащие данные о Билле Гейтсе(72B) и Ларри Эллисоне(41B) и запомните размер их дохода.
3. Напишите шаблон регулярного выражения и используйте функцию ``grep``, чтобы извлечь размер дохода из данных в векторе _html_.
```{r}
incomes<-grep("[$](\\d+,*\\d*) B", html)
incomes
```
Удостоверьтесь, что полученный вектор номеров строк содержит содержит ровно 100 записей и ссылается на номера строк в котрых действительно есть
информация о доходе, а не просто первый попавшийся текст.
```{r}
html[incomes]
length(incomes)
```
Напишите код, использовав регулярное выражение из п. 3, и функции ``regexp`` и ``regmatches``, чтобы извлечь все данные о доходе.
```{r}
incomes.positions<-regexpr("[$](\\d+,*\\d*) B", html)
incomes.value<-regmatches(html,incomes.positions)
incomes.positions
incomes.value
```
Проверьте следующее:
   1. Должно быть ровно сто значений.
```{r}
length(incomes.value)
```
   2. Самый большой доход должен быть доход Билла Гейтса
```{r}
incomes.value[1]
```
   3. Такой доход должен быть в списке один раз.
```{r}
length(incomes.value[incomes.value=="$72 B"])
```
   4. В всписке должна быть цифра, которую мы запомнили для Ларри Эллисона.
```{r}
incomes.value[3]
```
   5. Должно быть как минимум два значения, встречающихся несколько раз.
```{r}
length(unique(incomes.value))
```

### Задание 2
5. В данных доход представлен в формате **"$42 B"**, что означает **42 × 10^9**.
Преобразуйте этот формат в числовой и сохраните в вектор _worths_. 
```{r}
worths<-as.numeric(sub(",",".", regmatches(incomes.value, regexpr('(\\d+,*\\d*)',incomes.value))))*10^9 
worths
```
Удостоверьтесь в следующем:
   1. _worths_ является вектором и в нём сто занчений типа _double_.
```{r}
is.vector(worths)
typeof(worths)
```
   2. Все элементы вектора _worths_ больше 1 миллиарда.
```{r}
length(worths[worths>10^9])
```
   3. Самое большое число это доход Билла Гейтса.
```{r}
worths[which(worths==max(worths))]
```
6. Используйте вектор _worths_ , чтобы выяснить следующее:
   1. Какова медиана ста этих записей?
```{r}
median(worths)
```
   2. Средний доход?
```{r}
mean(worths)
```
   3. Как много людей из этого списка имеют доход больше 5млрд., 10, 25?
```{r}
length(worths[worths>5*10^9])
length(worths[worths>10*10^9])
length(worths[worths>25*10^9])
```
   1. Какой их общий доход?
```{r}
sum(worths)
```
   2. Какую долю от общего дохода, составляет пятёрка самых богатых.
```{r}
sum(worths[1:5])/sum(worths)
```
   3. Какую долю от общего дохода, составляют 20 самых богатых.
```{r}
sum(worths[1:20])/sum(worths)
```
   4. В данных [федерального резерва США](https://www.federalreserve.gov/releases/z1/current/html/introductory_text.htm) найдите
   показатель дохода всех домохозяйств (Household net worth) в соответвующем году, какую долю
   общего дохода составляют 100 богатейших людей.
```{r}
household.2013 <- 78.332*10^12
sum(worths)/household.2013
```

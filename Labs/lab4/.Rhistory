data <- read.csv("https://archive.ics.uci.edu/ml/machine-learning-databases/abalone/abalone.data", header=TRUE, sep=",")
summary(data)
colnames(data)
colnames(data) <- c("sex", "length", "diameter", "height",
"whole_weight", "shucked_weight",
"viscera_weight", "shell_weight", "rings")
colnames(data)
data$sex <- factor(c("Female", "Infant", "Male")[data$sex])
par(mfrow=c(1,3))
hist(data$diameter, main = "Диаметр моллюска, мм")
hist(data$height, main = "Высота моллюска, мм")
hist(data$whole_weight, main = "Полный вес моллюска, гр")
par(mfrow=c(1,2))
plot(data$diameter, data$whole_weight,'p',main = "Зависимость веса от диаметра ")
plot(data$height, data$whole_weight,'p',main = "Зависимость веса от высоты")
#Линейная модель зависимости веса от диаметра моллюска
linear.model.weight.from.diameter<-lm(whole_weight~diameter,data)
linear.model.weight.from.diameter
summary(linear.model.weight.from.diameter)
plot(linear.model.weight.from.diameter)
#Линейная модель зависимости веса от высоты моллюска
linear.model.weight.from.height<-lm(whole_weight~height,data)
linear.model.weight.from.height
summary(linear.model.weight.from.height)
plot(linear.model.weight.from.height)
#Определение отклонений для линейной модели зависимости веса от диаметра моллюска
data.noout<-data[data$height<0.4&data$height>0.03&data$diameter>0.1,]
linear.model.weight.from.diameter.deviation<-lm(whole_weight~diameter,data.noout)
linear.model.weight.from.diameter.deviation
summary(linear.model.weight.from.diameter.deviation)
plot(linear.model.weight.from.diameter.deviation)
#Определение отклонений для линейной модели зависимости веса от диаметра моллюска
data.noout<-data[data$height<0.4&data$height>0.05,]
linear.model.weight.from.height.deviation<-lm(whole_weight~height,data.noout)
linear.model.weight.from.height.deviation
summary(linear.model.weight.from.height.deviation)
plot(linear.model.weight.from.height.deviation)
#Линейная модель зависимости веса от высоты и диаметра моллюска
linear.model.weight.from.height.and.diameter<-lm(whole_weight~+height+diameter,data.noout)
linear.model.weight.from.height.and.diameter
summary(linear.model.weight.from.height.and.diameter)
plot(linear.model.weight.from.height.and.diameter)
#Линейная модель физических характеристик моллюсков всё в одном
linear.model.all<-lm(whole_weight~.-shucked_weight-viscera_weight-shell_weight,data.noout)
linear.model.all
summary(linear.model.all)
plot(linear.model.all)
odds <- seq(1, nrow(data.noout), by=2)
data.in <- data.noout[odds,]
data.out <- data.noout[-odds,]
odds <- seq(1, nrow(data.noout), by=2)
data.in <- data.noout[odds,]
data.out <- data.noout[-odds,]
linear.model.all.in<-lm(whole_weight~.-shucked_weight-viscera_weight-shell_weight,data=data.in)
linear.model.all.in
summary(linear.model.all.in)
plot(linear.model.all.in)
data.predict.out <- predict (linear.model.all.in, data.out)
plot (data.out$whole_weight, data.predict.out)
cor (data.out$whole_weight, data.predict.out)
